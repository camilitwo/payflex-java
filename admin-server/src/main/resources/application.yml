server:
  port: ${PORT:9090}
  forward-headers-strategy: framework  # <-- crítico detrás de proxy (X-Forwarded-Host/Proto)

spring:
  application.name: admin-server
  security.user.name: admin
  security.user.password: ${ADMIN_PWD:SuperSeguro123}
  boot.admin.discovery.enabled: true
  boot.admin.discovery.converter.management-context-path: /actuator

management.endpoints.web.exposure.include: "*"

eureka.client.serviceUrl.defaultZone: ${EUREKA_URL:http://discovery-server:8761/eureka}
eureka.instance.hostname: ${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:localhost}}
eureka.instance.prefer-ip-address: false
eureka.instance.non-secure-port: ${PORT:${server.port:9090}}
eureka.instance.secure-port-enabled: false
eureka.instance.instance-id: "${spring.application.name}:${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:9090}}"
eureka.instance.home-page-url: http://${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:9090}}/
eureka.instance.status-page-url: http://${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:9090}}/actuator/info
eureka.instance.health-check-url: http://${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:9090}}/actuator/health
eureka.instance.metadata-map.management.port: ${MANAGEMENT_SERVER_PORT:${PORT:${server.port:9090}}}
eureka.instance.metadata-map.management.context-path: ${management.endpoints.web.base-path:/actuator}

---

spring:
  profiles: sleep

  boot:
    admin:
      # El propio server se puede dejar arriba o apagarlo completo
      # Aquí deshabilitamos la integración por discovery
      discovery:
        enabled: false

  security:
    user:
      name: admin
      password: ${ADMIN_PWD:admin}  # no se usa en sleep, pero evita fallos si arranca

eureka:
  client:
    enabled: false

management:
  endpoints:
    web:
      exposure:
        include: "health"
  endpoint:
    health:
      probes:
        enabled: true
      show-details: NEVER

logging:
  level:
    root: WARN

