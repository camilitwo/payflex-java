server:
  port: ${PORT:8082}

spring:
  application:
    name: payment-orchestrator
  data:
    redis:
      host: ${REDISHOST:crossover.proxy.rlwy.net}
      port: 59000
      password: ${REDISPASSWORD:}
      username: ${REDISUSER:}

# Configuración de idempotencia
idempotency:
  enabled: ${IDEMPOTENCY_ENABLED:true}
  fail-on-redis-error: ${IDEMPOTENCY_FAIL_ON_ERROR:false}
  boot:
    admin:
      client:
        url: ${SPRING_BOOT_ADMIN_URL:http://admin:9090}
eureka:
  client:
    serviceUrl:
      defaultZone: ${EUREKA_URL:http://discovery-server:8761/eureka}
  instance:
    hostname: ${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:localhost}}
    prefer-ip-address: false
    non-secure-port: ${PORT:${server.port:8082}}
    secure-port-enabled: false
    instance-id: "${spring.application.name}:${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:8082}}"
    home-page-url: http://${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:8082}}/
    status-page-url: http://${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:8082}}/actuator/info
    health-check-url: http://${EUREKA_INSTANCE_HOST:${RAILWAY_PRIVATE_DOMAIN:${HOSTNAME}}}:${PORT:${server.port:8082}}/actuator/health
    metadata-map:
      management.port: ${MANAGEMENT_SERVER_PORT:${PORT:${server.port:8082}}}
      management.context-path: ${management.endpoints.web.base-path:/actuator}
management:
  endpoints:
    web:
      exposure:
        include: "*"
  health:
    redis:
      enabled: true
    defaults:
      enabled: true
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true

---
# Configuración para desarrollo local
spring:
  config:
    activate:
      on-profile: local
  data:
    redis:
      host: localhost
      port: 6379
      password:
      username: default

idempotency:
  enabled: false  # Deshabilitar idempotencia en local si no tienes Redis

eureka:
  client:
    enabled: false
    serviceUrl:
      defaultZone: http://localhost:8761/eureka
  instance:
    hostname: localhost
    prefer-ip-address: false

logging:
  level:
    com.payflex.config.RedisHealthConfig: ERROR  # Silenciar warnings de Redis en local
    org.springframework.data.redis: ERROR

